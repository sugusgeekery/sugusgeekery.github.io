import{d as e,m as o,u as i,n as a,q as t,s as n,I as s,p as l,e as d,o as r,f as c,h as m,F as v,t as f,v as p,g as u,x as g,z as C,A as h,w as x}from"./vendor.54beb8e3.js";import{g as L,R as b,a as N,b as y,W as k,c as I}from"./index.9997e8f1.js";import{_ as V,a as R,b as U}from"./verification.d87d2f67.js";var j=e({name:"LoginView",components:{},setup(){const e=o(),l=i(),d=a((()=>l.state.verificationCodeNumber)),r=a((()=>l.state.loginNavIndex)),c=a((()=>l.state.loginNavList)),m=t(""),v=t(""),f=t(""),p=()=>{const e=y("code"),o=y("phone");var i;o?(i={phoneNo:o},l.dispatch(N.PhoneLogin,i)):e&&(e=>{l.dispatch(N.WechatLogin,e)})({jsCode:e})},{currentRoute:u}=e;var g;return n((()=>u.value.fullPath),(()=>{p()})),f.value=L({appid:k,redirectUri:encodeURIComponent(I+"/#/login")}),g=0,l.commit(b.UpdateVerificationCodeNumber,g),p(),{verificationCodeNumber:d,loginNavIndex:r,loginNavList:c,updateLoginNavIndex:e=>l.commit(b.UpdateLoginNavIndex,e),phone:m,code:v,iframeSrc:f,sendVerifyCode:()=>{var e;m?(e={phone:m,type:0},l.dispatch(N.GetVerificationCode,e)):s.error("请输入手机号码")},validateCtl:e=>{if("phone"==e){const e=/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,o=m.value||"";""!=o&&(e.test(o)||(s.error("手机号码格式不对"),m.value=""))}else if("code"==e){const e=/^[\d]{6}$/,o=v.value||"";""!=o&&(e.test(o)||(s.error("验证码格式不对"),v.value=""))}},verificationLoginCtl:()=>{var e;m?v?(e={phone:m,code:v},l.dispatch(N.VerificationCodelogin,e)):s.error("请输入验证码"):s.error("请输入手机号码")},toRegister:()=>{e.push("/register")}}}});const w=x();l("data-v-33248cdc");const K={id:"Login",class:"context"},_=m("img",{class:"background",src:V,alt:""},null,-1),P={class:"content"},S={class:"model"},W={class:"model-navs"},$={key:0,class:"model-section"},q={key:1,class:"model-section"},z={class:"model-form"},A={class:"model-form-item"},F=m("img",{class:"model-form-image",src:R,alt:""},null,-1),G={class:"model-form-item"},T=m("img",{class:"model-form-image",src:U,alt:""},null,-1),B={key:0,class:"model-form-text-button model-form-text-button-active"},D={class:"model-form-buttons"};d();const E=w(((e,o,i,a,t,n)=>(r(),c("div",K,[_,m("div",P,[m("div",S,[m("div",W,[(r(!0),c(v,null,f(e.loginNavList,((o,i)=>(r(),c("div",{class:["model-nav",{"model-nav-active":e.loginNavIndex===i}],key:i,onClick:o=>e.updateLoginNavIndex(i)},p(o.text),11,["onClick"])))),128))]),0===e.loginNavIndex?(r(),c("div",$,[m("iframe",{class:"model-iframe",src:e.iframeSrc,frameborder:"0",allowTransparency:"true",scrolling:"no"},null,8,["src"]),m("div",{class:"model-text",onClick:o[1]||(o[1]=o=>e.toRegister())},"免费注册")])):u("v-if",!0),1===e.loginNavIndex?(r(),c("div",q,[m("div",z,[m("div",A,[F,g(m("input",{class:"model-form-input",type:"text",placeholder:"请输入手机号","onUpdate:modelValue":o[2]||(o[2]=o=>e.phone=o),onChange:o[3]||(o[3]=o=>e.validateCtl("phone")),onKeyup:o[4]||(o[4]=h(((...o)=>e.verificationLoginCtl&&e.verificationLoginCtl(...o)),["enter"]))},null,544),[[C,e.phone]])]),m("div",G,[T,g(m("input",{class:"model-form-input",type:"text",placeholder:"手机验证码","onUpdate:modelValue":o[5]||(o[5]=o=>e.code=o),onChange:o[6]||(o[6]=o=>e.validateCtl("code")),onKeyup:o[7]||(o[7]=h(((...o)=>e.verificationLoginCtl&&e.verificationLoginCtl(...o)),["enter"]))},null,544),[[C,e.code]]),e.verificationCodeNumber>0?(r(),c("div",B," 还剩"+p(e.verificationCodeNumber)+"秒 ",1)):(r(),c("div",{key:1,class:["model-form-text-button",{"model-form-text-button-active":e.phone}],onClick:o[8]||(o[8]=(...o)=>e.sendVerifyCode&&e.sendVerifyCode(...o))}," 发送验证码 ",2))]),m("div",D,[m("div",{class:"model-form-button",onClick:o[9]||(o[9]=(...o)=>e.verificationLoginCtl&&e.verificationLoginCtl(...o)),onKeyup:o[10]||(o[10]=h(((...o)=>e.verificationLoginCtl&&e.verificationLoginCtl(...o)),["enter"]))}," 登录 ",32)])]),m("div",{class:"model-text",onClick:o[11]||(o[11]=o=>e.toRegister())},"免费注册")])):u("v-if",!0)])])]))));j.render=E,j.__scopeId="data-v-33248cdc";export default j;
