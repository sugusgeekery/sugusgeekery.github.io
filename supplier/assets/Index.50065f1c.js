import{d as e,m as i,u as t,n as s,q as l,i as a,p as n,e as c,o,f as d,h as m,F as p,t as f,g as r,v,x as u,C as b,w as h}from"./vendor.54beb8e3.js";import{S,r as k,B as y,s as I}from"./index.9997e8f1.js";import{U as g}from"./upload.13485518.js";var x=e({name:"ProcessView",components:{},setup(){i();const e=t(),n=s((()=>e.state.order.process.initInfo)),c=s((()=>e.state.order.process.machinStepList)),o=s((()=>e.state.order.process.assembleStepList)),d=s((()=>e.state.order.process.injectionStepList)),m=i=>e.dispatch(`order/process/${k.GetMachinSteps}`,i),p=i=>e.dispatch(`order/process/${k.GetAssembleSteps}`,i),f=i=>e.dispatch(`order/process/${k.GetInjectionSteps}`,i),r=i=>e.commit(`order/process/${I.UpdateMachinStepList}`,i),v=i=>e.commit(`order/process/${I.UpdateAssembleStepList}`,i),u=i=>e.commit(`order/process/${I.UpdateInjectionStepList}`,i),b=l(-1),h=l(-1),x=e=>{const{id:i,fileName:t,filePath:s}=e||{};1===h.value?(c[b.value].fileInfos=[...c[b.value].fileInfos||[],{filePath:s,fileName:t,fileId:i}],r(c)):2===h.value?(o[b.value].fileInfos=[...o[b.value].fileInfos||[],{filePath:s,fileName:t,fileId:i}],v(o)):3===h.value&&(d[b.value].fileInfos=[...d[b.value].fileInfos||[],{filePath:s,fileName:t,fileId:i}],u(d))};return a((()=>{const{type:e=""}=n||{};switch(e){case S.Dfm:case S.Design:break;case S.Machining:m(),p();break;case S.Injection:f()}})),{Supplier:S,BASE_IMAGE_URL:y,initInfo:n,machinStepList:c,assembleStepList:o,injectionStepList:d,finishedStep:i=>e.dispatch(`order/process/${k.FinishedStep}`,i),deleteStepFile:i=>e.dispatch(`order/process/${k.DeleteStepFile}`,i),getMachinSteps:m,getAssembleSteps:p,getInjectionSteps:f,updateMachinStepList:r,updateAssembleStepList:v,updateInjectionStepList:u,pasteIndex:b,pasteType:h,selectFile:({type:e=0,index:i=0})=>{b.value=i,h.value=e;document.querySelector("#file").click()},uploadFile:async e=>{const i=e.target.files,t=await g({files:i});for(const s of t)x(s);e.target.value=null},updateFile:x}}});const L=h();n("data-v-584d4117");const F={class:"process"},C={key:0,class:"items"},N=m("div",{class:"items-text"},"加工",-1),j={class:"item-label"},A={class:"item-content"},M={class:"item-content-title"},P={key:0,class:"item-buttons"},_={key:1,class:"item-images"},E={key:1,class:"items"},U=m("div",{class:"items-text"},"装配",-1),$={class:"item-label"},G={class:"item-content"},B={class:"item-content-title"},w={key:0,class:"item-buttons"},R={key:1,class:"item-images"},D={key:2,class:"items"},X=m("div",{class:"items-text"},"试模",-1),q={class:"item-label"},T={class:"item-content"},V={class:"item-content-title"},z={key:0,class:"item-buttons"},H={key:1,class:"item-images"};c();const J=L(((e,i,t,s,l,a)=>(o(),d("div",F,[m("input",{type:"file",name:"file",hidden:"hidden",id:"file",accept:"image/*",onChange:i[1]||(i[1]=(...i)=>e.uploadFile&&e.uploadFile(...i))},null,32),e.initInfo.type===e.Supplier.Machining&&e.machinStepList&&e.machinStepList.length?(o(),d("div",C,[N,(o(!0),d(p,null,f(e.machinStepList,((i,t)=>(o(),d("div",{class:"item",key:t},[m("div",j,[m("div",{class:["item-label-top",{"item-label-top-blue":i.isFinished||1===i.isNext}]},null,2),m("div",{class:["item-label-circle",{"item-label-circle-blue":i.isFinished||1===i.isNext}]},null,2),t<e.machinStepList.length-1?(o(),d("div",{key:0,class:["item-label-bottom",{"item-label-bottom-blue":i.isFinished}]},null,2)):r("v-if",!0)]),m("div",A,[m("div",M,v(i.stepName),1)]),1===i.isNext?(o(),d("div",P,[m("div",{class:"item-button item-button-blue",onClick:i=>e.selectFile({type:1,index:t})}," 上传照片 ",8,["onClick"]),m("div",{class:"item-button",onClick:i=>e.finishedStep({type:1,index:t})},"完成",8,["onClick"])])):r("v-if",!0),i.fileInfos&&i.fileInfos.length?(o(),d("div",_,[(o(!0),d(p,null,f(i.fileInfos,((s,l)=>u((o(),d("div",{class:"item-image",key:l},[m("img",{class:"item-image-icon",src:e.BASE_IMAGE_URL+s.filePath,alt:""},null,8,["src"]),1===i.isNext?(o(),d("div",{key:0,class:"item-image-delete",onClick:i=>e.deleteStepFile({type:1,index:t,key:l})}," X ",8,["onClick"])):r("v-if",!0)],512)),[[b,s.filePath]]))),128))])):r("v-if",!0)])))),128))])):r("v-if",!0),e.initInfo.type===e.Supplier.Machining&&e.assembleStepList&&e.assembleStepList.length?(o(),d("div",E,[U,(o(!0),d(p,null,f(e.assembleStepList,((i,t)=>(o(),d("div",{class:"item",key:t},[m("div",$,[m("div",{class:["item-label-top",{"item-label-top-blue":i.isFinished||1===i.isNext}]},null,2),m("div",{class:["item-label-circle",{"item-label-circle-blue":i.isFinished||1===i.isNext}]},null,2),t<e.assembleStepList.length-1?(o(),d("div",{key:0,class:["item-label-bottom",{"item-label-bottom-blue":i.isFinished}]},null,2)):r("v-if",!0)]),m("div",G,[m("div",B,v(i.stepName),1)]),1===i.isNext?(o(),d("div",w,[m("div",{class:"item-button item-button-blue",onClick:i=>e.selectFile({type:2,index:t})}," 上传照片 ",8,["onClick"]),m("div",{class:"item-button",onClick:i=>e.finishedStep({type:2,index:t})},"完成",8,["onClick"])])):r("v-if",!0),i.fileInfos&&i.fileInfos.length?(o(),d("div",R,[(o(!0),d(p,null,f(i.fileInfos,((s,l)=>u((o(),d("div",{class:"item-image",key:l},[m("img",{class:"item-image-icon",src:e.BASE_IMAGE_URL+s.filePath,alt:""},null,8,["src"]),1===i.isNext?(o(),d("div",{key:0,class:"item-image-delete",onClick:i=>e.deleteStepFile({type:2,index:t,key:l})}," X ",8,["onClick"])):r("v-if",!0)],512)),[[b,s.filePath]]))),128))])):r("v-if",!0)])))),128))])):r("v-if",!0),e.initInfo.type===e.Supplier.Injection&&e.injectionStepList&&e.injectionStepList.length?(o(),d("div",D,[X,(o(!0),d(p,null,f(e.injectionStepList,((i,t)=>(o(),d("div",{class:"item",key:t},[m("div",q,[m("div",{class:["item-label-top",{"item-label-top-blue":i.isFinished||1===i.isNext}]},null,2),m("div",{class:["item-label-circle",{"item-label-circle-blue":i.isFinished||1===i.isNext}]},null,2),t<e.injectionStepList.length-1?(o(),d("div",{key:0,class:["item-label-bottom",{"item-label-bottom-blue":i.isFinished}]},null,2)):r("v-if",!0)]),m("div",T,[r(' <div\r\n            class="item-content-text"\r\n            v-if="initInfo.type === Supplier.Injection"\r\n          >\r\n            20201112\r\n          </div> '),m("div",V,v(i.stepName),1)]),1===i.isNext?(o(),d("div",z,[m("div",{class:"item-button item-button-blue",onClick:i=>e.selectFile({type:3,index:t})}," 上传照片 ",8,["onClick"]),m("div",{class:"item-button",onClick:i=>e.finishedStep({type:3,index:t})},"完成",8,["onClick"])])):r("v-if",!0),i.fileInfos&&i.fileInfos.length?(o(),d("div",H,[(o(!0),d(p,null,f(i.fileInfos,((s,l)=>u((o(),d("div",{class:"item-image",key:l},[m("img",{class:"item-image-icon",src:e.BASE_IMAGE_URL+s.filePath,alt:""},null,8,["src"]),1===i.isNext?(o(),d("div",{key:0,class:"item-image-delete",onClick:i=>e.deleteStepFile({type:3,index:t,key:l})}," X ",8,["onClick"])):r("v-if",!0)],512)),[[b,s.filePath]]))),128))])):r("v-if",!0)])))),128))])):r("v-if",!0)]))));x.render=J,x.__scopeId="data-v-584d4117";export default x;
